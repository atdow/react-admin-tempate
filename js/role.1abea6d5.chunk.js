(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{478:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(516),r=a.n(n),c=a(60),l=a.n(c),i=a(78),o=a.n(i);function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=JSON.parse(r()(e));if(0===e.length)return[];l()(t).call(t,(function(e){l()(t).call(t,(function(t){e.parentId===t.id&&(t.children?t.children.push(e):t.children=[e])}))}));var a=o()(t).call(t,(function(e){return 0===e.parentId}));return a}},709:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return Se}));var n=a(37),r=a.n(n),c=a(131),l=(a(486),a(490)),i=(a(442),a(443)),o=(a(487),a(489)),u=(a(459),a(467)),s=(a(460),a(468)),m=(a(668),a(236)),d=(a(670),a(690)),f=(a(672),a(698)),h=a(55),p=a(56),b=a(87),v=a(86),g=a(85),E=a(57),y=a(58),O=(a(697),a(692)),j=(a(542),a(491)),R=a(536),k=a.n(R),I=a(537),C=a.n(I),x=a(456),S=a.n(x),w=a(0),q=a.n(w),F=a(444),N=a(551),M=a(538),T=(a(677),a(694)),P=(a(259),a(179)),D=(a(679),a(693)),V=(a(541),a(495)),K=(a(540),a(492)),A=a(116),J=a(549),B=a(550),G=a(60),H=a.n(G),L=a(78),_=a.n(L),z=a(44),Q=a.n(z),U=a(681),W=a.n(U),X=a(683),Y=a.n(X),Z=a(112),$=a.n(Z),ee=a(151),te=a.n(ee),ae=a(152),ne=a.n(ae),re=a(153),ce=a.n(re),le=a(217),ie=a.n(le),oe=a(218),ue=a.n(oe),se=a(114),me=a.n(se);function de(e){return me()({url:"/pt/changeRolePerssionInfo",method:"post",data:e})}var fe=a(478),he=["onRoleInfoChange"];function pe(e,t){var a=$()(e);if(te.a){var n=te()(e);t&&(n=_()(n).call(n,(function(t){return ne()(e,t).enumerable}))),a.push.apply(a,n)}return a}function be(e){for(var t=1;t<arguments.length;t++){var a,n=null!=arguments[t]?arguments[t]:{};if(t%2)H()(a=pe(Object(n),!0)).call(a,(function(t){Object(y.a)(e,t,n[t])}));else if(ce.a)ie()(e,ce()(n));else{var r;H()(r=pe(Object(n))).call(r,(function(t){ue()(e,t,ne()(n,t))}))}}return e}var ve,ge,Ee=s.a.TextArea,ye={labelCol:{span:4},wrapperCol:{span:24}},Oe=[],je=Object(w.forwardRef)((function(e,t){var a=e.onRoleInfoChange,n=(Object(B.a)(e,he),Object(w.useState)(!1)),r=Object(J.a)(n,2),m=r[0],d=r[1],f=Object(w.useState)(!1),h=Object(J.a)(f,2),p=h[0],b=h[1],v=Object(w.useRef)(null),g=Object(w.useState)([]),E=Object(J.a)(g,2),y=E[0],O=E[1],j=Object(w.useState)([]),R=Object(J.a)(j,2),k=R[0],I=R[1],C=Object(w.useState)([]),x=Object(J.a)(C,2),S=x[0],F=x[1],N=Object(w.useState)([]),M=Object(J.a)(N,2),G=M[0],L=M[1],z=Object(w.useState)(!0),U=Object(J.a)(z,2),X=U[0],Z=U[1],$=Object(w.useState)(!1),ee=Object(J.a)($,2),te=ee[0],ae=ee[1],ne=Object(w.useState)(!1),re=Object(J.a)(ne,2),ce=re[0],le=re[1];Object(w.useImperativeHandle)(t,(function(){return{show:function(e){var t;ve=e,ie(!0),I([]),F([]),L([]),ae(!1),le(!1),null===(t=v.current)||void 0===t||t.resetFields(),b(!0),me()({url:"/pt/getMenuTree",method:"get"}).then((function(t){var a=t.data||{};if(200===a.code){var n=a.data||[];Oe=Object(A.a)(n);var r,c=Object(fe.a)(n||[]);!function e(t){H()(t).call(t,(function(t){t.title=null==t?void 0:t.meta.title,t.key=t.id,t.children&&t.children.length>0&&e(t.children)}))}(c),O(c),(r={id:e},me()({url:"/pt/getRolePerssionInfo",method:"get",params:r})).then((function(e){var t=e.data,a=void 0===t?{}:t;if(200===a.code){var n=a.data||{},r=function(e){var t=Object(fe.a)(e||[]),a=[];function n(e){H()(e).call(e,(function(e){e.children&&0!=e.children.length?n(e.children):a.push(e.id)}))}return n(t),a}(n.menu||[]);F(r);n.menu;I(r),v.current.setFieldsValue({roleName:n.roleName,permissonCharacter:n.permissonCharacter,status:0===n.status,menuPerssion:r,comment:n.comment})}else ie(!1)})).catch((function(e){ie(!1)})).finally((function(){b(!1)}))}else ie(!1)})).catch((function(e){b(!1),ie(!1)})).finally((function(){return[]}))}}})),Object(w.useEffect)((function(){}),[]);var ie=function(e){d(e)},oe=function(){d(!1)},ue=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];v.current.validateFields().then((function(t){b(!0),delete t.menuPerssion;var n=[];H()(S).call(S,(function(e){var t=_()(Oe).call(Oe,(function(t){return t.id===e}))[0];n.push(e),t&&0!==t.parentId&&-1===Q()(n).call(n,t.parentId)&&n.push(t.parentId)})),n=W()(new Y.a(n)),de(be(be({id:ve},t),{},{status:!0===t.status?0:1,menu:n})).then((function(t){200===t.data.code&&a&&(a(!0),!0===e&&oe())})).catch((function(e){a(!1)})).finally((function(){b(!1)}))})).catch((function(e){}))};return q.a.createElement("div",null,q.a.createElement(T.a,{title:"修改角色",placement:"right",closable:!1,onClose:oe,visible:m,key:"right",width:500,footer:q.a.createElement("div",{style:{textAlign:"right"}},q.a.createElement(i.a,{className:"margin-right-10",onClick:function(){return d(!1)},loading:!1},"取消"),q.a.createElement(i.a,{className:"margin-right-10",type:"primary",onClick:function(){return ue(!1)},loading:p},"保存"),q.a.createElement(i.a,{type:"primary",onClick:function(){return ue(!0)},loading:p},"保存并关闭"))},q.a.createElement(P.a,{spinning:p},q.a.createElement(u.a,Object(c.a)({ref:v},ye,{name:"basic",initialValues:{remember:!0}}),q.a.createElement(u.a.Item,{label:"角色名",name:"roleName",rules:[{required:!0,message:"请输入角色名!"}]},q.a.createElement(s.a,{placeholder:"请输入角色名!"})),q.a.createElement(u.a.Item,{label:"权限字符",name:"permissonCharacter",rules:[{required:!0,message:"请输入权限字符!"}]},q.a.createElement(s.a,{placeholder:"请输入权限字符!"})),q.a.createElement(u.a.Item,{label:"状态",name:"status",rules:[{required:!0,message:"选择状态!"}]},q.a.createElement(K.a.Group,{value:!0},q.a.createElement(K.a,{value:!0},"正常"),q.a.createElement(K.a,{value:!1},"停用"))),q.a.createElement(u.a.Item,{label:"菜单权限",name:"menuPerssion",rules:[{required:!1,message:"请选择菜单权限!"}]},q.a.createElement(l.a,null,q.a.createElement(o.a,{span:24,style:{height:"32px"},className:"flex-align-center"},q.a.createElement(V.a,{checked:te,onChange:function(e){if(!0===e.target.checked){ae(!0);var t=[];H()(Oe).call(Oe,(function(e){t.push(e.id)})),I(t)}else ae(!1),I([])}},"展开或折叠"),q.a.createElement(V.a,{checked:ce,onChange:function(e){if(!0===e.target.checked){le(!0);var t=[];H()(Oe).call(Oe,(function(e){t.push(e.id)})),F(t)}else le(!1),F([])}},"全选或全不选")),q.a.createElement(o.a,{span:24},q.a.createElement("div",{style:{border:"1px solid #d9d9d9"}},q.a.createElement(D.a,{checkable:!0,onExpand:function(e){I(e),Z(!1)},expandedKeys:k,autoExpandParent:X,checkStrictly:!1,onCheck:function(e){F(e)},checkedKeys:S,onSelect:function(e,t){L(e)},selectedKeys:G,treeData:y}))))),q.a.createElement(u.a.Item,{label:"备注",name:"comment",rules:[{required:!1,message:"请输入备注!"}]},q.a.createElement(Ee,{rows:4,placeholder:"请输入备注!"}))))))}));function Re(e){var t=function(){if("undefined"==typeof Reflect||!r.a)return!1;if(r.a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=Object(E.a)(e);if(t){var c=Object(E.a)(this).constructor;a=r()(n,arguments,c)}else a=n.apply(this,arguments);return Object(g.a)(this,a)}}var ke=j.a.Option,Ie=O.a.RangePicker;var Ce={labelCol:{span:8},wrapperCol:{span:16}},xe={onChange:function(e,t){console.log("selectedRowKeys: ".concat(e),"selectedRows: ",t)},getCheckboxProps:function(e){return{disabled:!1,name:e.name}}},Se=Object(F.a)((function(e){return{}}),(function(e){return{}}))(ge=function(e){Object(v.a)(a,e);var t=Re(a);function a(e){var n;return Object(h.a)(this,a),n=t.call(this,e),Object(y.a)(Object(b.a)(n),"formRef",void 0),Object(y.a)(Object(b.a)(n),"tableRef",void 0),Object(y.a)(Object(b.a)(n),"RoleModifyModalRef",void 0),n.formRef=q.a.createRef(),n.tableRef=q.a.createRef(),n.RoleModifyModalRef=q.a.createRef(),n.state={expand:!1,statusConfimText:'确认要"停用""超级管理员"角色吗?',columns:[{title:"角色编号",dataIndex:"roleIndex",key:"roleIndex"},{title:"角色名称",dataIndex:"roleName",key:"roleName"},{title:"权限字符",dataIndex:"permissonCharacter",key:"permissonCharacter"},{title:"显示顺序",dataIndex:"displaySequence",key:"displaySequence"},{title:"状态",dataIndex:"status",key:"status",render:function(e,t){return q.a.createElement(d.a,{placement:"top",title:function(e){var t="确认要";return t+=!0===e.status?'"停用"':'"启用"',t+='"'.concat(e.roleName,'"'),t+="角色吗?"}(t),onConfirm:function(e){n.chageRoleStatus(e,t)},okText:"确定",cancelText:"取消"},q.a.createElement(f.a,{checked:0===e}))}},{title:"创建时间",dataIndex:"createTime",key:"createTime"},{title:"操作",dataIndex:"opetation",key:"opetation",render:function(e,t){return q.a.createElement("div",null,q.a.createElement("a",{href:"#!",onClick:function(e){return n.handleMoify(e,t)}},q.a.createElement(N.a,null),"修改"))}}],formValue:{},tableDataSource:function(e){return function(e){return me()({url:"/pt/roleList",method:"post",data:e})}(k()(e,n.state.formValue)).then((function(e){return(e.data||{}).data}))}},n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){}},{key:"onFinish",value:function(e){this.setState({formValue:e}),this.tableRef.current.request(!0)}},{key:"onFinishFailed",value:function(e){C()(e),e.errorFields,e.outOfDate}},{key:"chageRoleStatus",value:function(e,t){var a,n=this;(a={id:t.id},me()({url:"/pt/changeRoleStatus",method:"post",data:a})).then((function(e){200===e.data.code&&(m.b.success("修改成功"),n.tableRef.current.request())})).catch((function(e){m.b.error("修改失败")})).finally((function(){}))}},{key:"handleMoify",value:function(e,t){e.preventDefault(),this.RoleModifyModalRef.current.show(t.id)}},{key:"onRoleInfoChange",value:function(e){!0===e&&this.tableRef.current.request()}},{key:"render",value:function(){var e,t,a=this;return q.a.createElement("div",{className:"backround-white padding-20"},q.a.createElement(u.a,Object(c.a)({ref:this.formRef,name:"advanced_search"},Ce,{className:"ant-advanced-search-form",onFinish:S()(e=this.onFinish).call(e,this),onFinishFailed:this.onFinishFailed}),q.a.createElement(l.a,{gutter:24},q.a.createElement(o.a,{span:5},q.a.createElement(u.a.Item,{name:"roleName",label:"角色名称",rules:[{required:!1,message:"Input something!"}]},q.a.createElement(s.a,{placeholder:"请输入角色名称"}))),q.a.createElement(o.a,{span:5},q.a.createElement(u.a.Item,{name:"permissonCharacter",label:"权限字符",rules:[{required:!1,message:"Input something!"}]},q.a.createElement(s.a,{placeholder:"请输入权限字符"}))),q.a.createElement(o.a,{span:5},q.a.createElement(u.a.Item,{name:"status",label:"状态",rules:[{required:!1,message:"Input something!"}]},q.a.createElement(j.a,{placeholder:"请选择状态"},q.a.createElement(ke,{value:0},"正常"),q.a.createElement(ke,{value:1},"停用")))),q.a.createElement(o.a,{span:5},q.a.createElement(u.a.Item,{name:"createdTime",label:"创建时间",rules:[{required:!1,message:"Input something!"}]},q.a.createElement(Ie,{showTime:!0}))),q.a.createElement(o.a,{span:4,style:{textAlign:"right"}},q.a.createElement(i.a,{type:"primary",htmlType:"submit"},"搜索"),q.a.createElement(i.a,{style:{margin:"0 8px"},onClick:function(){a.formRef.current.resetFields()}},"清除")))),q.a.createElement(M.a,{ref:this.tableRef,columns:this.state.columns,dataSource:this.state.tableDataSource,className:"margin-top-20",rowSelection:xe}),q.a.createElement(je,{ref:this.RoleModifyModalRef,onRoleInfoChange:S()(t=this.onRoleInfoChange).call(t,this)}))}}]),a}(q.a.Component))||ge}}]);