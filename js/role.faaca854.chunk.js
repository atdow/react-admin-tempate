(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{453:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(485),r=a.n(n),l=a(157),c=a.n(l),o=a(139),i=a.n(o);function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=JSON.parse(r()(e));if(0===e.length)return[];c()(t).call(t,(function(e){c()(t).call(t,(function(t){e.parentId===t.id&&(t.children?t.children.push(e):t.children=[e])}))}));var a=i()(t).call(t,(function(e){return 0===e.parentId}));return a}},665:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return X}));var n=a(34),r=a.n(n),l=a(122),c=(a(504),a(514)),o=(a(419),a(420)),i=(a(505),a(513)),u=(a(435),a(444)),s=(a(436),a(445)),m=(a(637),a(223)),d=(a(639),a(647)),f=(a(641),a(654)),h=a(53),p=a(54),b=a(82),E=a(81),y=a(80),v=a(55),g=a(83),O=a(506),j=a.n(O),k=a(507),I=a.n(k),R=a(434),C=a.n(R),x=a(0),S=a.n(x),w=a(421),F=a(519),q=a(508),M=(a(643),a(650)),N=(a(247),a(167)),T=(a(645),a(649)),D=(a(509),a(464)),P=a(517),V=a(157),K=a.n(V),J=a(107),A=a.n(J);var B,G=a(453),H=s.a.TextArea,L={labelCol:{span:4},wrapperCol:{span:24}},_={wrapperCol:{offset:0,span:24}},z=Object(x.forwardRef)((function(e,t){Object(l.a)({},e);var a=Object(x.useState)(!1),n=Object(P.a)(a,2),r=n[0],c=n[1],i=Object(x.useState)(!1),m=Object(P.a)(i,2),d=m[0],f=m[1],h=Object(x.useRef)(null),p=Object(x.useState)([]),b=Object(P.a)(p,2),E=b[0],y=b[1],v=Object(x.useState)([]),g=Object(P.a)(v,2),O=g[0],j=g[1],k=Object(x.useState)([]),I=Object(P.a)(k,2),R=I[0],C=I[1],w=Object(x.useState)([]),F=Object(P.a)(w,2),q=F[0],V=F[1],J=Object(x.useState)(!0),B=Object(P.a)(J,2),z=B[0],Q=B[1];function U(e){c(e)}Object(x.useImperativeHandle)(t,(function(){return{show:function(e){U(!0),f(!0),A()({url:"/pt/getMenuTree",method:"get"}).then((function(t){var a=t.data||{};if(200===a.code){var n,r=a.data||{},l=Object(G.a)(r||[]);!function e(t){K()(t).call(t,(function(t){t.title=null==t?void 0:t.meta.title,t.key=t.id,t.children&&t.children.length>0&&e(t.children)}))}(l),y(l),(n={id:e},A()({url:"/pt/getRolePerssionInfo",method:"get",params:n})).then((function(e){var t=e.data,a=void 0===t?{}:t;if(200===a.code){var n=a.data||{},r=function(e){var t=Object(G.a)(e||[]),a=[];function n(e){K()(e).call(e,(function(e){e.children&&0!=e.children.length?n(e.children):a.push(e.id)}))}return n(t),a}(n.menu||[]);C(r);n.menu;j(r),h.current.setFieldsValue({roleName:n.roleName,permissonCharacter:n.permissonCharacter,status:n.status,menuPerssion:r,comment:n.comment})}else U(!1)})).catch((function(e){U(!1)})).finally((function(){f(!1)}))}else U(!1)})).catch((function(e){f(!1),U(!1)})).finally((function(){return[]}))}}})),Object(x.useEffect)((function(){}),[]);return S.a.createElement("div",null,S.a.createElement(M.a,{title:"修改角色",placement:"right",closable:!1,onClose:function(){c(!1)},visible:r,key:"right",width:500},S.a.createElement(N.a,{spinning:d},S.a.createElement(u.a,Object(l.a)({ref:h},L,{name:"basic",initialValues:{remember:!0},onFinish:function(){},onFinishFailed:function(){}}),S.a.createElement(u.a.Item,{label:"角色名",name:"roleName",rules:[{required:!0,message:"请输入角色名!"}]},S.a.createElement(s.a,{placeholder:"请输入角色名!"})),S.a.createElement(u.a.Item,{label:"权限字符",name:"permissonCharacter",rules:[{required:!0,message:"请输入权限字符!"}]},S.a.createElement(s.a,{placeholder:"请输入权限字符!"})),S.a.createElement(u.a.Item,{label:"状态",name:"status",rules:[{required:!0,message:"选择状态!"}]},S.a.createElement(D.a.Group,{value:!0},S.a.createElement(D.a,{value:!0},"正常"),S.a.createElement(D.a,{value:!1},"停用"))),S.a.createElement(u.a.Item,{label:"菜单权限",name:"menuPerssion",rules:[{required:!0,message:"选择菜单权限!"}]},S.a.createElement(T.a,{checkable:!0,onExpand:function(e){console.log("onExpand",e),j(e),Q(!1)},expandedKeys:O,autoExpandParent:z,checkStrictly:!1,onCheck:function(e){console.log("onCheck",e),C(e)},checkedKeys:R,onSelect:function(e,t){console.log("onSelect",t),V(e)},selectedKeys:q,treeData:E})),S.a.createElement(u.a.Item,{label:"备注",name:"comment",rules:[{required:!1,message:"请输入备注!"}]},S.a.createElement(H,{rows:4,placeholder:"请输入备注!"})),S.a.createElement(u.a.Item,_,S.a.createElement(o.a,{type:"primary",htmlType:"submit",loading:!1},"登录"))))))}));function Q(e){var t=function(){if("undefined"==typeof Reflect||!r.a)return!1;if(r.a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=Object(v.a)(e);if(t){var l=Object(v.a)(this).constructor;a=r()(n,arguments,l)}else a=n.apply(this,arguments);return Object(y.a)(this,a)}}var U={labelCol:{span:8},wrapperCol:{span:16}},W={onChange:function(e,t){console.log("selectedRowKeys: ".concat(e),"selectedRows: ",t)},getCheckboxProps:function(e){return{disabled:!1,name:e.name}}},X=Object(w.a)((function(e){return{}}),(function(e){return{}}))(B=function(e){Object(E.a)(a,e);var t=Q(a);function a(e){var n;return Object(h.a)(this,a),n=t.call(this,e),Object(g.a)(Object(b.a)(n),"formRef",void 0),Object(g.a)(Object(b.a)(n),"tableRef",void 0),Object(g.a)(Object(b.a)(n),"RoleModifyModalRef",void 0),n.formRef=S.a.createRef(),n.tableRef=S.a.createRef(),n.RoleModifyModalRef=S.a.createRef(),n.state={expand:!1,statusConfimText:'确认要"停用""超级管理员"角色吗?',columns:[{title:"角色编号",dataIndex:"roleIndex",key:"roleIndex"},{title:"角色名称",dataIndex:"roleName",key:"roleName"},{title:"权限字符",dataIndex:"permissonCharacter",key:"permissonCharacter"},{title:"显示顺序",dataIndex:"displaySequence",key:"displaySequence"},{title:"状态",dataIndex:"status",key:"status",render:function(e,t){return S.a.createElement(d.a,{placement:"top",title:function(e){var t="确认要";return t+=!0===e.status?'"停用"':'"启用"',t+='"'.concat(e.roleName,'"'),t+="角色吗?"}(t),onConfirm:function(e){n.confirm(e,t)},okText:"确定",cancelText:"取消"},S.a.createElement(f.a,{checked:e,onChange:function(e){n.onStatusChange(e,t)}}))}},{title:"创建时间",dataIndex:"createTime",key:"createTime"},{title:"操作",dataIndex:"opetation",key:"opetation",render:function(e,t){return S.a.createElement("div",null,S.a.createElement("a",{href:"#!",onClick:function(e){return n.handleMoify(e,t)}},S.a.createElement(F.a,null),"修改"))}}],formValue:{},tableDataSource:function(e){return function(e){return A()({url:"/pt/roleList",method:"post",data:e})}(j()(e,n.state.formValue)).then((function(e){return(e.data||{}).data}))}},n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){}},{key:"onFinish",value:function(e){this.setState({formValue:e}),this.tableRef.current.request(!0)}},{key:"onFinishFailed",value:function(e){I()(e),e.errorFields,e.outOfDate}},{key:"onStatusChange",value:function(e,t){}},{key:"confirm",value:function(e,t){var a,n=this;(a={id:t.id},A()({url:"/pt/changeRoleStatus",method:"post",data:a})).then((function(e){200===e.data.code&&(m.b.success("修改成功"),n.tableRef.current.request())})).catch((function(e){m.b.error("修改失败")})).finally((function(){}))}},{key:"handleMoify",value:function(e,t){e.preventDefault(),this.RoleModifyModalRef.current.show(t.id)}},{key:"render",value:function(){var e,t=this;return S.a.createElement("div",{className:"backround-white padding-20"},S.a.createElement(u.a,Object(l.a)({ref:this.formRef,name:"advanced_search"},U,{className:"ant-advanced-search-form",onFinish:C()(e=this.onFinish).call(e,this),onFinishFailed:this.onFinishFailed}),S.a.createElement(c.a,{gutter:24},S.a.createElement(i.a,{span:5},S.a.createElement(u.a.Item,{name:"roleName",label:"角色名称",rules:[{required:!1,message:"Input something!"}]},S.a.createElement(s.a,{placeholder:"placeholder"}))),S.a.createElement(i.a,{span:5},S.a.createElement(u.a.Item,{name:"permissonCharacter",label:"权限字符",rules:[{required:!1,message:"Input something!"}]},S.a.createElement(s.a,{placeholder:"placeholder"}))),S.a.createElement(i.a,{span:5},S.a.createElement(u.a.Item,{name:"status",label:"状态",rules:[{required:!1,message:"Input something!"}]},S.a.createElement(s.a,{placeholder:"placeholder"}))),S.a.createElement(i.a,{span:5},S.a.createElement(u.a.Item,{name:"createdTime",label:"创建时间",rules:[{required:!1,message:"Input something!"}]},S.a.createElement(s.a,{placeholder:"placeholder"}))),S.a.createElement(i.a,{span:4,style:{textAlign:"right"}},S.a.createElement(o.a,{type:"primary",htmlType:"submit"},"搜索"),S.a.createElement(o.a,{style:{margin:"0 8px"},onClick:function(){t.formRef.current.resetFields()}},"清除")))),S.a.createElement(q.a,{ref:this.tableRef,columns:this.state.columns,dataSource:this.state.tableDataSource,className:"margin-top-20",rowSelection:W}),S.a.createElement(z,{ref:this.RoleModifyModalRef}))}}]),a}(S.a.Component))||B}}]);